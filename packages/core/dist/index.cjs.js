"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),n=e(t),r=require("react-native"),o=e(require("react-navigation")),i=e(require("react-navigation-stack"));function u(e){if("REACT"==e)return n;if("REACT_NATIVE"==e)return r;if("REACT_NAVIGATION"==e)return o;if("REACT_NAVIGATION_STACK"==e)return i;throw"require unsupported external module: ".concat(e)}function a(e,t){return t(e).then((function(e){return e.text()})).then((function(e){var t={};return new Function("exports","require",e)(t,u),t.__esModule?t.default:t}))}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?h(e):t}var m=function(){};function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.Loading,o=e.ErrorTips,i=e.trackRenderError,u=void 0===i?m:i,s=e.injectFetch;if(!r)throw"invailed options, prop `Loading` is required";if(!o)throw"invailed options, prop `ErrorTips` is required";return(function(e){function i(e){var t;return c(this,i),l(h(t=y(this,v(i).call(this,e))),"handleRetry",(function(){t.setState({error:!1})})),l(h(t),"handleRefresh",(function(){t.buildComponent(),t.setState({refreshTag:Date.now()})})),t.state={error:!1,refreshTag:0},t.focusEvent=null,t.buildComponent(),t}return p(i,n.Component),f(i,[{key:"buildComponent",value:function(){var e=this.props.navigation.getParam("url");this.RemoteComponent=n.lazy((function(){return a(e,s||fetch)}))}},{key:"addFocusEvent",value:function(){var e=this.props.navigation;this.focusEvent=e.addEventListener("didFocus",this.handleFocus)}},{key:"removeFocusEvent",value:function(){this.focusEvent&&(this.focusEvent.remove(),this.focusEvent=null)}},{key:"handleFocus",value:function(){var e=this.props,t=e.navigation,n=e.onBackToTop;1===t.dangerouslyGetParent().routes.length&&"function"==typeof n&&n()}},{key:"componentDidCatch",value:function(e){u(e),this.setState({error:!0})}},{key:"componentDidMount",value:function(){this.addFocusEvent()}},{key:"componentWillUnmount",value:function(){this.removeFocusEvent()}},{key:"render",value:function(){var e=this.RemoteComponent,i=this.state,u=i.error,a=i.refreshTag;return u?n.createElement(o,{onRetry:this.handleRetry}):n.createElement(t.Suspense,{key:a,fallback:n.createElement(r,null)},n.createElement(e,this.props))}}]),i}())}var b=E({Loading:function(){return n.createElement(r.View,null)},ErrorTips:function(){return n.createElement(r.View,null)},trackRenderError:console.warn}),g=Symbol("symbol for dynamic-rn-container");exports.CONTAINER=g,exports.RemoteComponentContainer=b,exports.createContainer=E,exports.loadRemoteComponent=a;
