import t,{Suspense as e}from"react";import*as n from"react-native";import{View as r}from"react-native";import o from"react-navigation";function i(e){if("REACT"==e)return t;if("REACT_NATIVE"==e)return n;if("REACT_NAVIGATION"==e)return o;throw"require unsupported external module: "+e}function a(t,e){return void 0===e&&(e=fetch),e(t).then((function(t){return t.text()})).then((function(t){var e={};return new Function("exports","require",t)(e,i),e.__esModule?e.default:e}))}var u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(){};function p(n){var r=n.Loading,o=n.ErrorTips,i=n.trackRenderError,p=void 0===i?s:i,f=n.injectFetch;if(!r)throw"invailed options, prop `Loading` is required";if(!o)throw"invailed options, prop `ErrorTips` is required";return(function(n){function i(t){var e=n.call(this,t)||this;return e.handleRetry=function(){e.setState({error:!1})},e.handleRefresh=function(){e.buildComponent(),e.setState({refreshTag:Date.now()})},e.getStackDepth=function(){var t,n=null===(t=e.props.navigation.dangerouslyGetParent())||void 0===t?void 0:t.state;return n&&n.routes?n.routes.length:1},e.state={error:!1,refreshTag:0},e.focusEvent=null,e.buildComponent(),e}return function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(i,n),i.prototype.buildComponent=function(){var e=this.props.navigation.getParam("url");t.lazy((function(){return a(e,f||fetch)}))},i.prototype.addFocusEvent=function(){var t=this.props.navigation;this.focusEvent=t.addListener("didFocus",this.handleFocus)},i.prototype.removeFocusEvent=function(){this.focusEvent&&(this.focusEvent.remove(),this.focusEvent=null)},i.prototype.handleFocus=function(){var t=this.props.onBackToTop;1===this.getStackDepth()&&"function"==typeof t&&t()},i.prototype.componentDidCatch=function(t){p(t),this.setState({error:!0})},i.prototype.componentDidMount=function(){this.addFocusEvent()},i.prototype.componentWillUnmount=function(){this.removeFocusEvent()},i.prototype.render=function(){var n=this.RemoteComponent,i=this.state,a=i.error,u=i.refreshTag;return a?t.createElement(o,{onRetry:this.handleRetry}):t.createElement(e,{key:u,fallback:t.createElement(r,null)},t.createElement(n,c({},this.props)))},i}(t.Component))}var f=p({Loading:function(){return t.createElement(r,null)},ErrorTips:function(){return t.createElement(r,null)},trackRenderError:console.warn}),l=Symbol("symbol for dynamic-rn-container");export{l as CONTAINER,f as RemoteComponentContainer,p as createContainer,a as loadRemoteComponent};
