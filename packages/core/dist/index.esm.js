import t,{Suspense as n}from"react";import*as e from"react-native";import{View as r}from"react-native";import o from"react-navigation";function i(n){if("REACT"==n)return t;if("REACT_NATIVE"==n)return e;if("REACT_NAVIGATION"==n)return o;throw"require unsupported external module: "+n}function a(t,n){return void 0===n&&(n=fetch),n(t).then((function(t){return t.text()})).then((function(t){var n={};return new Function("exports","require",t)(n,i),n.__esModule?n.default:n}))}var u=function(t,n){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};var c=function(){return(c=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},s=function(){};function p(e){var r=e.Loading,o=e.ErrorTips,i=e.trackRenderError,p=void 0===i?s:i,f=e.injectFetch;if(!r)throw"invailed options, prop `Loading` is required";if(!o)throw"invailed options, prop `ErrorTips` is required";return(function(e){function i(t){var n=e.call(this,t)||this;return n.handleRetry=function(){n.setState({error:!1})},n.handleRefresh=function(){n.buildComponent(),n.setState({refreshTag:Date.now()})},n.state={error:!1,refreshTag:0},n.focusEvent=null,n.buildComponent(),n}return function(t,n){function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}(i,e),i.prototype.buildComponent=function(){var n=this.props.navigation.getParam("url");t.lazy((function(){return a(n,f||fetch)}))},i.prototype.addFocusEvent=function(){var t=this.props.navigation;this.focusEvent=t.addListener("didFocus",this.handleFocus)},i.prototype.removeFocusEvent=function(){this.focusEvent&&(this.focusEvent.remove(),this.focusEvent=null)},i.prototype.handleFocus=function(){var t,n=this.props,e=n.navigation,r=n.onBackToTop;1===(null===(t=e.dangerouslyGetParent())||void 0===t?void 0:t.routes.length)&&"function"==typeof r&&r()},i.prototype.componentDidCatch=function(t){p(t),this.setState({error:!0})},i.prototype.componentDidMount=function(){this.addFocusEvent()},i.prototype.componentWillUnmount=function(){this.removeFocusEvent()},i.prototype.render=function(){var e=this.RemoteComponent,i=this.state,a=i.error,u=i.refreshTag;return a?t.createElement(o,{onRetry:this.handleRetry}):t.createElement(n,{key:u,fallback:t.createElement(r,null)},t.createElement(e,c({},this.props)))},i}(t.Component))}var f=p({Loading:function(){return t.createElement(r,null)},ErrorTips:function(){return t.createElement(r,null)},trackRenderError:console.warn}),l=Symbol("symbol for dynamic-rn-container");export{l as CONTAINER,f as RemoteComponentContainer,p as createContainer,a as loadRemoteComponent};
